CREATE PROCEDURE dbo.DynamicPivotSql
  @PivotColumn  NVARCHAR(255),
  @DataToPivot    NVARCHAR(255)
AS
BEGIN
 
  DECLARE @Sql NVARCHAR(MAX)
  SET @Sql = N'
    SELECT * FROM (
      SELECT
        ApplicationFamily,
        ApplicationStatus,
        AppCount
      FROM App
    ) StudentResults
    PIVOT (
      SUM([Marks])
      FOR ['+@ColumnToPivot+']
      IN (
        '+@ListToPivot+'
      )
    ) AS PivotTable
  ';
 
  EXEC(@SqlStatement)
 
END
